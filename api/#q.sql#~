select urls.id,t2.browser,t2.os,t2.device_type,sum(case when t3.total_clicks is not null then t3.total_clicks else 0 end) as sum from urls left join (select id,count(*) as total_clicks from logs group by id order by total_clicks desc) t3 on urls.id = t3.id
left join
(select distinct id,(select browser from logs where id = t.id group by browser order by count(*) desc limit 1) browser,
(select os from logs where id = t.id group by os order by count(*) desc limit 1) os,
(select device_type from logs where id = t.id group by device_type order by count(*) desc limit 1)device_type
from logs t) t2 on  urls.id = t2.id group by urls.id,t2.browser,t2.os,t2.device_type order by sum desc;





select browser,browser_count,os,os_count,device_type,device_count,t0.total_clicks from (select id,count(*) as total_clicks from logs where id='rscctN' group by id)t0 full outer join  (select browser,count(*) as browser_count,row_number () over() as num from logs where id='rscctN' group by browser order by browser_count desc) t1 on 1=1
left join                                                                                                              
(select os,count(*) as os_count, row_number() over() as num from logs where id='rscctN'  group by os order by os_count desc) t2 on t1.num = t2.num                                                                                                   
left join 
(select device_type,count(*) as device_count , row_number() over() as num from logs where id='rscctN' group by device_type order by device_count desc)t3 on t2.num = t3.num


insert into logs values('http://google.com','','ios','safari','mobile',current_timestamp,'0.0.0.0','','','','','EFfRsW')
